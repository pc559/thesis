%\input{commands}
\chapter{An Inflationary Constraint from the $\cmb$ Bispectrum}\label{chapter:constraints}
\section{$\dbi$ sound speed constraint}
    In this chapter, we use $\planck$ data to place a constraint on $\dbi$ inflation.
    We then compare this result to a constraint on the same parameter obtained by the $\planck$
    collaboration~\cite{Planck_NG_2018},
    with the aim of validating the full $\primodal$-$\cmbbest$ pipeline.
    The $\planck$ result was obtained by constraining the amplitude
    of the $\dbi$ template~\eqref{dbi_shape}, and using a slow-roll relation~\eqref{fnl_dbi_defn}
    to map this to a constraint on the sound speed.
    In our pipeline, in contrast, we scan over a fundamental parameter of the model, $\bir$,
    with the other parameters of the model held fixed.
    This means the sound speed is not a constant, and is instead found by numerically evolving the background.
    We use $c_s^*$ to refer to the sound speed at horizon crossing of the pivot scale.
    We obtain the full shape and amplitude information (within our $k$-range) for
    each scenario in our scan and the final
    constraint makes use of the entirety of that information, up to
    convergence in $\Pmax$.


    In the context of the scan described in section~\ref{sec:setup},
    we used the methods described in previous chapters (as implemented in
    the $\primodal$ code) to generate shape coefficients for each scenario in the scan.
    The $\cmbbest$ code, which implements the methods described in~\cite{Sohn_2021},
    then used the $\planck$ temperature data to place a constraint
    on $\bir$.
    At present $\cmbbest$ has only been run for the $\Lnsinv$ basis
    with $\Pmax=30$, so to make contact with it the $\primodal$ scan
    was run with the same basis\footnote{
        Other basis sets described in chapter~\ref{chapter:decomp} will be used in future runs of $\cmbbest$.
    }.
    As shown in figure~\ref{fig:dbi_sound_speed_scan_beta}, we find
    \begin{align}\label{eq:cmbbest_bir_constraint}
        \bir\le0.46\qquad(95\%,~T~\text{only}).
    \end{align}
    This translates onto a constraint
    on the sound speed at horizon crossing of
    \begin{align}\label{eq:cmbbest_dbi_constraint}
        c_s^{*}\ge0.056\qquad(95\%,~T~\text{only}).
    \end{align}


    Equation (55) in~\cite{Planck_NG_2018} presents the 
    constraint on the sound speed during $\dbi$ inflation
    derived from the $\cmb$ bispectrum using the $\modal$ estimator
    \begin{align}\label{eq:planck_dbi_constraint}
        c_s^{\dbi}&\ge0.079\qquad(95\%,~T~\text{only},~\modal)
    \end{align}
    using the definition~\eqref{fnl_dbi_defn} and the template~\eqref{dbi_shape}.
    While our goal was to use this previous constraint as a validation of our own pipeline,
    it is not unexpected that we did not reproduce it exactly.
    One possible reason for this is the fact we are using slightly different
    scales---since we are limited to $\kmax/\kmin=1000$ for convergence reasons, we cannot
    use all the scales in the $\planck$ data. Another possible reason is convergence in the number of
    maps---$\modal$ uses $\sim300$ maps while $\cmbbest$ uses $140$. Numerical issues and
    implementation error could also contribute. See~\cite{Sohn_2021} for an in-depth discussion of these possibilities.
    We can however understand the expected variance of such estimators by simply examining the
    scatter between the estimators used within the $\planck$ analysis.
    Note that this is not statistical variance, but simply method variance.
    We show this in figure~\ref{fig:equil_constraints_comparison} for the equilateral template~\eqref{equil_shape}
    which is closely related to the $\dbi$ template.
    We see that the result obtained by $\cmbbest$ is different, but still lies
    between the results of the $\ksw$ and $\modal$ estimators.


    \begin{figure}[htbp!]
        \centering
        %\includegraphics[width=0.9\textwidth]{wuhyun_plots/beta_ir_constraint_busy.png}
        \includegraphics[width=0.9\textwidth]{wuhyun_plots/beta_ir_constraint_with_beta.png}
        \caption{
            The constraint we obtain on $\dbi$ inflation. Here $c_s^{\dbi}$ is not an input parameter,
            unlike in the template case. Instead it is time dependent, and the value plotted as $c_s^{\dbi}$
            here is the value at horizon crossing of the pivot scale, which can be used to label the
            scenarios we scanned over.
            We find that $\bir<0.46$
            %0.464
            is outside of our $2\sigma$ confidence interval. This plot was obtained by
            scanning across values of $\bir$ and calculating the corresponding primordial bispectra
            using $\primodal$, then projecting those bispectra onto the $\cmb$
            and comparing them to the $\planck$ $\cmb$ temperature data using
            $\cmbbest$. Since the amplitude is fixed by the scenario, we rule out a
            scenario by ruling out $f_{NL}^{\dbi}=1$.
            %We can see that the $\cmbbest$ result does not agree with the $\modal$
            %result~\eqref{eq:planck_dbi_constraint},
            %but as we see in figure~\ref{fig:equil_constraints_comparison},
            %the discrepancy is not unexpected. We discuss possible explanations in the text.
            Note that the $\bir$ is approximately inversely proportional to $c^*_s$.
            %\textcolor{red}{is it?}
        }\label{fig:dbi_sound_speed_scan_beta}
    \end{figure}


    \begin{figure}[htbp!]
        \centering
        \includegraphics[width=0.9\textwidth]{wuhyun_plots/fnl_equil_planck_scatter.png}
        \caption{
            A comparison of the various estimation methods used in $\planck$,
            as presented in table 5 of~\cite{Planck_NG_2018},
            with the $\cmbbest$ result, presented in~\cite{Sohn_2021}.
            We plot the constraints obtained by each method for $\fnlequil$,
            along with their $68\%$ uncertainty margin.
            Note that all the estimation methods use the same data
            \textcolor{red}{and maps},
            and are near optimal, hence their uncertainty margins are close
            to identical.
            We see that while the estimators do not agree, there is no discrepancy with any
            significance---in particular, we see that $\cmbbest$ is not an outlier.
            Possible contributions to the difference in the central values are convergence in each
            method (for their respective convergence parameters), implementation error,
            and numerical stability. It is important to note that the differences between the
            different results are not due to statistical variance.
            The $\cmbbest$ result quoted here was obtained by decomposing the equilateral
            template~\eqref{equil_shape} (using definition~\eqref{planck_fnl_defn_ns} for $\fnlequil$)
            in the $\Lnsinv$ basis for $\Pmax=30$.
            \textcolor{red}{Which is the abstract one in Planck?}
        }\label{fig:equil_constraints_comparison}
    \end{figure}


\section{Connecting to $\cmbbest$}\label{sec:setup}
The potential we use is the IR one discussed in~\cite{Bean_ir_dbi}, as
we outlined in section~\ref{sec:interactions}.
See also~\cite{Chen_dbi, warp_features_dbi} for further discussions.
    We use equation~\eqref{eq:dbi_warp}, which has four free parameters,
    $\bir$, $\lambda_{\dbi}$, $\phi_0$, and $V_0$.
    We use $\bir$ to parameterise our scan,
    which we take across the range
    \begin{align}\label{eq:bir_range}
        \bir\in[0.1885, 0.58].
    \end{align}
    with the parameters
    \begin{align}\label{eq:scan_params}
        \lambda_{\dbi}&=2.00475\times10^{15}\\
        V_0 &= 5.2\times10^{-12}\mpl^4\\
        \phi_0 &= 0.46042\mpl
    \end{align}
    held fixed.
    \textcolor{red}{Check units.}


    From~\cite{Chen_dbi} we can use slow-roll relations to determine the approximate
    values of the \textcolor{red}{number of e-folds?}. We find
    \begin{align}
        N_e &= \frac{\sqrt{\lambda_{\dbi}}H}{\phi}\approx112
    \end{align}
    which is \textcolor{red}{larger than it should be, but we can use it
    as a validation anyway?}
    We can also then write down the expected relation between the sound speed
    and $\bir$
    \begin{align}
        c_s &\approx \frac{3}{\bir N_e}.%&&\approx 0.054.
    \end{align}
    which we indeed find to be approximately true for our numerical results.
    We start the background evolution on the slow-roll attractor, finding initial conditions which
    satisfy the Friedman constraint, as discussed in section~\ref{sec:interactions}.
    For each scenario in this scan we ensure that $\ln\left(10^{10}A_s\right)$
    is within $3.044\pm0.014$,
    and that $n_s^{*}$ is within $0.9649\pm0.0042$.
    In table~\ref{tab:scan_summary_sr} we summarise the scenario parameters for the scan,
    and in table~\ref{tab:scan_summary_ns} we summarise the resulting scaling indices.
 

%    \begin{tabular}{lrrrrrrrrrr}
%        \toprule
%        $\bir$ &    $c_s^{*}$ &  $\varepsilon_s^{*}$ &   $\varepsilon^{*}$ &   $n_s^{*}$ &  $n_{NG}^{*}$ &   $\phi^{*}$ &     $H^{*}$ &   $\eta^{*}$ \\
%        \midrule
%        $1.89\times 10^{-1}$  &  $1.39\times 10^{-1}$  &  $  8.57\times 10^{-3}$  &  $7.44\times 10^{-5}$  &  $-3.50\times 10^{-2}$  &  $-8.72\times 10^{-2}$  &  $5.19\times 10^{-1}$  &  $1.31\times 10^{-6}$  &  $2.63\times 10^{-2}$ \\
%        $5.80\times 10^{-1}$  &  $4.50\times 10^{-2}$  &  $  8.67\times 10^{-3}$  &  $2.31\times 10^{-4}$  &  $-3.63\times 10^{-2}$  &  $-8.99\times 10^{-2}$  &  $5.15\times 10^{-1}$  &  $1.30\times 10^{-6}$  &  $2.71\times 10^{-2}$ \\
%        \bottomrule
%    \end{tabular}
    %in table~\ref{tab:scan_summary_bkgd} we summarise the background parameters,

\begin{table}[h!]
  \begin{center}
    \begin{tabular}{lrrrrrrr}
        \toprule
        $\bir$ &    $c_s^{*}$ &  $\varepsilon_s^{*}$ &   $\varepsilon^{*}$ &   $\eta^{*}$ &  $\phi^{*}$ &     $H^{*}$ \\
        \midrule
        $1.89\times 10^{-1}$  &  $1.39\times 10^{-1}$  &  $  8.57\times 10^{-3}$  &  $7.44\times 10^{-5}$  &  $2.63\times 10^{-2}$ &  $5.19\times 10^{-1}$  &  $1.31\times 10^{-6}$\\
        $5.80\times 10^{-1}$  &  $4.50\times 10^{-2}$  &  $  8.67\times 10^{-3}$  &  $2.31\times 10^{-4}$  &  $2.71\times 10^{-2}$ &  $5.15\times 10^{-1}$  &  $1.30\times 10^{-6}$\\
        \bottomrule
    \end{tabular}
    \caption{
        Summary of scenario parameters across the scan, evaluated at the horizon
      crossing of the pivot scale. \textcolor{red}{Remove something so it fits.}
      }\label{tab:scan_summary_sr}
  \end{center}
\end{table}


%\begin{table}[h!]
%  \begin{center}
%    \begin{tabular}{lrrr}
%        \toprule
%        $\bir$ &  $\phi^{*}$ &     $H^{*}$ \\
%        \midrule
%        $1.89\times 10^{-1}$  &  $5.19\times 10^{-1}$  &  $1.31\times 10^{-6}$\\
%        $5.80\times 10^{-1}$  &  $5.15\times 10^{-1}$  &  $1.30\times 10^{-6}$\\
%        \bottomrule
%    \end{tabular}
%    \caption{Summary of scenario parameters across the scan.}\label{tab:scan_summary_bkgd}
%  \end{center}
%\end{table}


\begin{table}[h!]
  \begin{center}
    \begin{tabular}{lrrrrrrr}
        \toprule
        $\bir$ &  $n_s^{*}$ &  $n_{NG}^{*}$\\
        \midrule
        $1.89\times 10^{-1}$  &  $9.650\times 10^{-1}$  &  $-8.72\times 10^{-2}$\\
        $5.80\times 10^{-1}$  &  $9.637\times 10^{-1}$  &  $-8.99\times 10^{-2}$\\
        \bottomrule
    \end{tabular}
      \caption{
          Summary of the slow-roll predictions for the scaling indices across the scan.
      }\label{tab:scan_summary_ns}
  \end{center}
\end{table}


\begin{figure}[htbp!]
\centering
    \subfloat[The $\scalingbasis$ basis]{\label{fig:prim_conv_log30}
        \includegraphics[width=\columnwidth]{dbi_scan_template_corrs_plots/dbi_primodal_scan_template_corrs_log30.png}}\\
    \subfloat[The $\Lnsinv$ basis]{\label{fig:prim_conv_p1ns30}
        \includegraphics[width=\columnwidth]{dbi_scan_template_corrs_plots/dbi_primodal_scan_template_corrs_p1ns30}}\\
\caption{
    The $\scalingbasis$ basis converges well across the scan range.
    We see that the bare $\dbi$ template is a poor match to the true numerical result.
    This is mostly due to the error in the overall magnitude.
    Once this is corrected, we see that the numerical result matches the
    approximate template to better than $1\%$. As the convergence of the
    numerical result is better than $0.1\%$ for the $\scalingbasis$ basis
    we can see that sum scaling~\eqref{dbi_sum_shape} and the
    product scaling~\eqref{dbi_prod_shape} perform
    comparably in matching the numerical result. This is mostly
    due to those templates neglecting the usual slow-roll suppressed
    contributions (as in~\eqref{malda_shape}),
    which do in fact become relevant to the primordial
    bispectrum deep enough into the squeezed limit, due to their local-type shape.
    The $\Lnsinv$ basis is sufficiently convergent across the scan range
    to obtain the desired constraint.
    We see that the convergence error is only slightly better than the error
    in the slow-roll corrected templates.
    Comparing the $\Lnsinv(\Pmax=30)$ result compared to
    templates~\eqref{dbi_shape},~\eqref{dbi_sum_shape} and~\eqref{dbi_prod_shape}.
    We also refit the result with $\Lnsinv(\Pmax=25)$, and compare with the full
    result to estimate the convergence at the primordial level.
}\label{fig:prim_conv}
\end{figure}

\begin{figure}[htbp!]
\centering
%\includegraphics[width=\columnwidth]{dbi_scan_template_corrs_plots/dbi_primodal_scan_fnl_errs_p1ns30}
\includegraphics[width=\columnwidth]{wuhyun_plots/errors_for_planck_map.png}
\caption{
    We plot the relative error in the value of $\fnl^{2\sigma}=\fnl+2\sigma$,
    between $\Pmax=30$ and $\Pmax=25$,
    with $\fnl$ obtained from $\planck$ map for each scenario in the scan.
    We see that the convergence across the majority of the scan is better than that of the
    convergence in the primordial bispectrum, as plotted in figure~\ref{fig:prim_conv}.
    This validates the $\Pmax$ convergence of our pipeline as a whole.
}\label{fig:cmb_conv}
\end{figure}


\section{Convergence}
    It is not obvious how the convergence of the primordial bispectrum translates to
    convergence of the estimate for $\fnl$, as different
    momentum configurations will be processed and projected differently.
    For example, if the primordial bispectrum has equal absolute error in a given
    equilateral configuration v.s.\ a squeezed configuration, will the error in
    each have comparable effect on the final constraint, or will one matter more?
    We will now discuss the convergence at the primordial level and compare it to
    the convergence in the final constraint.


    In figure~\ref{fig:prim_conv} we show convergence results for $\Lnsinv$ with $\Pmax=30$.
    For this basis the match to the template is good in the equilateral limit, but quite poor in the squeezed limit.
    The convergence in the $\scalingbasis$ basis is better,
    falling in the range $[10^{-4}, 10^{-3}]$.
    %$[1.02\times 10^{-4}, 9.24\times 10^{-4}]$.
    However, to connect to the $\cmbbest$ code we must use
    the $\Lnsinv$ basis. We see that it is sufficient for our purposes.
    When we examine the convergence to the sum~\eqref{dbi_sum_shape}
    and product~\eqref{dbi_prod_shape} scaling templates,
    in figure~\ref{fig:prim_conv},
    we see that neither is obviously the better match to the numerical result.
    This is due to the numerical result having a non-zero squeezed limit
    coming from the usual slow-roll suppressed local-type contributions
    (as in~\eqref{malda_shape}) which are neglected in the $\dbi$ templates.


%\begin{table}[h!]
%  \begin{center}
%    \begin{tabular}{lrrrr}
%        \toprule
%        $\bir$ & Sum Template & Product Template & Bare Template & With $\Pmax=25$ \\
%        \midrule
%        $1.89\times 10^{-1}$  &  $6.15\times 10^{-3}$  &  $7.22\times 10^{-3}$  &  $5.16\times 10^{-2}$  &  $5.3\times 10^{-3}$ \\
%        $5.80\times 10^{-1}$  &  $4.51\times 10^{-3}$  &  $3.63\times 10^{-3}$  &  $5.28\times 10^{-2}$  &  $2.6\times 10^{-3}$ \\
%        \bottomrule
%    \end{tabular}
%    \caption{
%        Comparing the $\Lnsinv(\Pmax=30)$ result compared to
%        templates~\eqref{dbi_shape},~\eqref{dbi_sum_shape} and~\eqref{dbi_prod_shape}.
%        We also refit the result with $\Lnsinv(\Pmax=25)$, and compare with the full
%        result to estimate the convergence at the primordial level.
%    }\label{tab:template_errors}
%  \end{center}
%\end{table}


\section{Slow-roll effects}
    The main slow-roll corrections are a correction to the overall amplitude,
    a deviation from perfect scale-dependence,
    and a local-type contribution in the squeezed limit which eventually comes to dominate
    the comoving curvature primordial bispectrum
    for sufficiently squeezed triangles.


    From figure~\ref{fig:dbi_sound_speed_scan_beta} we can quantitatively see that slow-roll
    suppressed effects, despite becoming dominant in the squeezed limit,
    do not appreciably affect the constraint on the $\dbi$ scenario.
    The constraint obtained from applying $\cmbbest$ to the $\Lnsinv$ decomposition
    of the $\dbi$ template~\eqref{dbi_shape} is plotted in figure~\ref{fig:dbi_sound_speed_scan_beta}.
    Comparing it to the constraint obtained using the $\primodal$ coefficients calculated
    from the in-in formalism (in the same figure) we see no significant difference.
    This also confirms that the difference between constraints~\eqref{eq:cmbbest_bir_constraint}
    and~\eqref{eq:planck_dbi_constraint} is not due to the more accurate shape function
    that we use.


%\section{EFT stuff, build off Enrico's recent work.}
%    Words
\section{Conclusions}
    Using our methods (as implemented in the $\primodal$ code) we can calculate the shape coefficients
    $\alpha_{pqr}$ for each value of $\bir$ in the scan described above.
    In this scan, these coefficients are with respect to the $\Lnsinv$ basis.
    Using these coefficients, we can use the methods described in~\cite{Sohn_2021} (as implemented
    in the $\cmbbest$ code) to place a constraint on the amplitude of that predicted bispectrum.
    This constraint uses the $\planck$ temperature data.
    The constraint then directly translates to a constraint on the inflationary parameters of that scenario,
    without the need for further approximations.
    This is done by giving the bispectrum of each scenario an amplitude
    parameter, which we call $\fnl$---this is then scenario specific, in contrast to previous works.
    Since by definition the scenario predicts $\fnl=1$,
    if it is found that $\fnl=1$ is ruled out for a given scenario, then that scenario is judged to
    be inconsistent with the data.


    Using this method we investigated the scenarios in the scan described in~\eqref{eq:bir_range}
    and~\eqref{eq:scan_params}. We found that $\bir\le0.46$ is ruled out at $95\%$ confidence---this
    is shown in figure~\ref{fig:dbi_sound_speed_scan_beta}.
    In this chapter we also quantified the convergence of this result, by comparing the full $\Pmax=30$
    result with the same results calculated for $\Pmax=25$. We found that this did not affect the
    final constraint, and concluded that our result has converged satisfactorily in $\Pmax$,
    both at the primordial level and the $\cmb$ level.
    We also quantified the effect of slow-roll corrections on the result,
    finding them to be negligible, as expected.


    Keeping the other scenario parameters~\eqref{eq:scan_params} held fixed,
    the $\planck$ constraint~\eqref{eq:planck_dbi_constraint}
    would instead imply that $\bir\le0.33$ is ruled out at $95\%$ confidence.
    The difference between our result and the $\planck$ result cannot be explained by
    statistical variance, as they are based on the same $\planck$ temperature data.
    However, as we see for $\fnlequil$ in figure~\ref{fig:equil_constraints_comparison},
    even between the estimation methods used within $\planck$ there is some variance.
    Possible contributions to this disagreement include convergence (for their respective convergence parameters),
    numerical errors, and differing numbers of Gaussian maps used \textcolor{red}{this obviously
    affects the convergence of $\sigma$, but does it affect $\fnl$? Through the normalisation?}


    Thus we conclude that our constraint on the $\dbi$ sound speed validates our pipeline as a whole,
    laying a solid foundation to move forward to shapes that have no standard template,
    obtaining totally new constraints.


